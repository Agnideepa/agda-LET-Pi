\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Languages.Let}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{‚Ñï}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Vec}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}‚à∑\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}[\AgdaUnderscore{}]=\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{lookup}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Fin}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Languages.MLPi}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Languages.PiTyped}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}√ó\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{val}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{[\AgdaUnderscore{},\AgdaUnderscore{}]}}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{left}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{right}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- Now we work with environments}\<%
\end{code}

%<*env-declare>
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}env}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{Œµ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{env}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}+‚Çë\AgdaUnderscore{}}}%
\>[65I]\AgdaSymbol{:}%
\>[66I]\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}\{}\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[66I]%
\>[9]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{env}}\<%
\\
%
\>[9]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{val}\AgdaSpace{}%
\AgdaBound{b}\AgdaSymbol{)}\<%
\\
\>[65I][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaComment{----------}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[9]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{env}}\<%
\end{code}
%</env-declare>


\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaFunction{Vec-elem}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{Fin}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ùïì}\<%
\\
\>[0]\AgdaFunction{Vec-elem}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{b}\<%
\\
\>[0]\AgdaFunction{Vec-elem}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{l}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Vec-elem}\AgdaSpace{}%
\AgdaBound{l}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}[\AgdaUnderscore{}]}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{env}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Fin}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{val}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{(}\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+‚Çë}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v}\<%
\\
\>[0]\AgdaSymbol{(}\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+‚Çë}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Failed attempt at shorter impl
\AgdaUnderscore{}[\AgdaUnderscore{}] : ‚àÄ\{n\}\{b\}\{x : Fin n\} ‚Üí ‚àÄ\{Œì : Vec ùïì n\} ‚Üí \{Œì [ x ]= b\} ‚Üí Œì env ‚Üí (x) ‚Üí val b
(œÅ +‚Çë v) [ zero ] = v
(œÅ +‚Çë \AgdaUnderscore{}) [ suc m ] = œÅ [ m ]
-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- Typing Rules and forming expressions}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}‚ä¢exp‚à∂\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{‚àÄ(}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{[]‚Çë}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[171I]\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[171I]%
\>[8]\AgdaComment{----------}\<%
\\
%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaInductiveConstructor{ùüô}\<%
\\
%
\>[2]\AgdaInductiveConstructor{left‚Çë}%
\>[181I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}\{}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSymbol{\}\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[181I]%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaBound{b‚ÇÅ}\<%
\\
%
\>[8]\AgdaComment{----------}\<%
\\
%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaInductiveConstructor{right‚Çë}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}\{}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSymbol{\}\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\<%
\\
%
\>[8]\AgdaComment{----------}\<%
\\
%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\AgdaSymbol{)}\<%
\end{code}

%<*debruijn>
\begin{code}%
%
\>[2]\AgdaInductiveConstructor{var‚Çë}%
\>[219I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\<%
\\
\>[219I][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Fin}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaComment{----------}\<%
\\
%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\<%
\end{code}
%</debruijn>

\begin{code}%
%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{‚Çëlet\AgdaUnderscore{}‚Çëin\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[15]\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}\{}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSymbol{\}\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaBound{b‚ÇÅ}\<%
\\
%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\<%
\\
%
\>[8]\AgdaComment{----------}\<%
\\
%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\<%
\end{code}
%<*fst-example>
\begin{code}%
%
\>[2]\AgdaInductiveConstructor{fst‚Çë}%
\>[257I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}\{}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSymbol{\}\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\<%
\\
\>[257I][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{√ó}}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaComment{----------}\<%
\\
%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaBound{b‚ÇÅ}\<%
\end{code}
%</fst-example>
\begin{code}%
%
\>[2]\AgdaInductiveConstructor{snd‚Çë}%
\>[276I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}\{}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSymbol{\}\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\<%
\\
\>[276I][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{√ó}}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaComment{----------}\<%
\\
%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\<%
\\
%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{<\AgdaUnderscore{},\AgdaUnderscore{}>‚Çë}}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[12]\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}\{}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSymbol{\}\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaBound{b‚ÇÅ}\<%
\\
%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\<%
\\
%
\>[8]\AgdaComment{----------}\<%
\\
%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{√ó}}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\AgdaSymbol{)}\<%
\end{code}

%<*case-example>
\begin{code}%
%
\>[2]\AgdaOperator{\AgdaInductiveConstructor{‚Çëcase\AgdaUnderscore{}‚ÇëL\AgdaUnderscore{}‚ÇëR\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}\{}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\AgdaSpace{}%
\AgdaBound{b‚ÇÉ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSymbol{\}\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaBound{b‚ÇÇ}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaBound{b‚ÇÉ}\<%
\\
%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚à∑}}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaBound{b‚ÇÉ}\<%
\\
%
\>[8]\AgdaComment{----------}\<%
\\
%
\>[8]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaBound{b‚ÇÉ}\<%
\end{code}
%</case-example>

\begin{code}%
\>[0]\<%
\\
\>[0]\AgdaComment{-- EVALUATION}\<%
\end{code}

%<*eval-declare>
\begin{code}%
\>[0]\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[347I]\AgdaSymbol{‚àÄ\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{‚Ñï}\AgdaSymbol{\}\{}\AgdaBound{Œì}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Vec}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}\{}\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ùïì}\AgdaSymbol{\}}\<%
\\
\>[347I][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{env}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{Œì}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚ä¢exp‚à∂}}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaDatatype{val}\AgdaSpace{}%
\AgdaBound{b}\<%
\end{code}
%</eval-declare>

\begin{code}%
\>[0]\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]‚Çë}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\end{code}

%<*left>
\begin{code}%
\>[0]\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{left‚Çë}\AgdaSpace{}%
\AgdaBound{e}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{left}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSymbol{)}\<%
\end{code}
%</left>

\begin{code}%
\>[0]\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{right‚Çë}\AgdaSpace{}%
\AgdaBound{e}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{right}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{var‚Çë}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{[}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{]}}\<%
\end{code}

%<*let>
\begin{code}%
\>[0]\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{‚Çëlet}}\AgdaSpace{}%
\AgdaBound{e‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚Çëin}}\AgdaSpace{}%
\AgdaBound{e‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+‚Çë}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaBound{e‚ÇÅ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{e‚ÇÇ}\<%
\end{code}
%</let>

\begin{code}%
\>[0]\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{fst‚Çë}\AgdaSpace{}%
\AgdaBound{e}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[20]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{[}}\AgdaSpace{}%
\AgdaBound{v‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{v‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{]}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v‚ÇÅ}\<%
\\
\>[0]\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{snd‚Çë}\AgdaSpace{}%
\AgdaBound{e}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[20]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{[}}\AgdaSpace{}%
\AgdaBound{v‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{v‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{]}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{v‚ÇÇ}\<%
\\
\>[0]\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{<}}\AgdaSpace{}%
\AgdaBound{e‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{e‚ÇÇ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{>‚Çë}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{[}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaBound{e‚ÇÅ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaBound{e‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{]}}\<%
\\
\>[0]\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{‚Çëcase}}\AgdaSpace{}%
\AgdaBound{e}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ÇëL}}\AgdaSpace{}%
\AgdaBound{e‚ÇÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{‚ÇëR}}\AgdaSpace{}%
\AgdaBound{e‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaBound{e}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[20]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{left}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+‚Çë}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{e‚ÇÅ}\<%
\\
\>[0]\AgdaSymbol{...}%
\>[20]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{right}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{eval‚Çë}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{œÅ}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+‚Çë}}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{e‚ÇÇ}\<%
\end{code}

        


